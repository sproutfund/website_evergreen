---
---
{{ "[" }}
{%- assign filtered_grants = site.data.grants | where: "show-hide","show" -%}
{%- assign static_files_paths = site.static_files | map: "path" -%}
{%- for grant in filtered_grants -%}
  {%- assign grant_slug = grant.project-slug -%}
  {%- if grant.featured == "TRUE" -%}
    {%- assign grant_featured = "true" -%}
    {%- if static_files_paths contains grant.photo -%}
      {%- assign grant_image = grant.photo -%}
    {%- else -%}
      {%- assign grant_image = "/photos/!placeholder.png" -%}
    {%- endif -%}
  {%- else -%}
    {%- assign grant_featured = "false" -%}
    {%- assign grant_image = grant.program | slugify | prepend: "/logos/" | append: ".png" -%}
  {%- endif -%}
  {
    "objectID"    : "{{ grant.grant-id }}",
    "featured"    : {{ grant_featured }},
    "year"        : {{ grant.year-display | to_integer }},
    "name"        : "{{ grant.project-name | smartify }}",
    "slug"        : "{{ grant_slug }}",
    "description" : "{{ grant.full-description | newline_to_br | strip_newlines | replace: '<br />', ' ' | strip_html | strip | smartify }}",
    "summary"     : "{{ grant.short-statement | newline_to_br | strip_newlines | replace: '<br />', ' ' | strip_html | strip | smartify }}",
    "orgs"        : "{{ grant.organizations | smartify }}",
    "amount"      : {{ grant.amount | replace: '$','' | replace: ',','' | to_integer }},
    "addon"       : "{{ grant.project-addon | smartify }}",
    "superprogram": "{{ grant.superprogram }}",
    "program"     : "{{ grant.program | smartify }}",
    "type"        : "{{ grant.type }}",
    "firstletter" : "{{ grant.first-letter }}",
    "image"       : "{{ grant_image | relative_url | prepend: 'https://sproutfund.github.io' }}",
    "url"         : "{{ grant.url-evergreen | relative_url | prepend: 'https://sproutfund.github.io' }}"
  }{%- unless forloop.last -%},{%- endunless -%}
{%- endfor -%}
{{ "]" }}
